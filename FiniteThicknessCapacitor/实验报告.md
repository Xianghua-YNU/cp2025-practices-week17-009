# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** [肖婷丹] **学号：** [20231050134] **完成日期：** [2025.6.18]

## 1. 实验目的

[本实验旨在通过数值模拟研究有限厚度平行板电容器的电势分布和电荷密度分布特性，掌握使用SOR迭代法求解拉普拉斯方程的数值计算方法，并验证导体表面电荷分布的基本物理规律。]

## 2. 核心算法

### 2.1 算法思路

[采用逐次超松弛(SOR)迭代法求解二维拉普拉斯方程，通过引入松弛因子ω(1<ω<2)加速收敛；设置导体区域为固定电势边界条件（上极板+100V，下极板-100V）；计算域边界设置为接地条件（0V）；迭代过程中仅更新非导体区域网格点的电势值；当相邻两次迭代的最大差值小于设定容差时判定收敛]

### 2.2 关键代码片段

```python
# SOR迭代核心代码
for iteration in range(max_iter):
    U_old = U.copy()
    max_error = 0.0
    
    for i in range(1, ny-1):
        for j in range(1, nx-1):
            if not conductor_mask[i, j]:  # 仅更新非导体区域
                U_new = 0.25 * (U[i+1,j] + U[i-1,j] + U[i,j+1] + U[i,j-1])
                U[i,j] = (1 - omega) * U[i,j] + omega * U_new
                
                error = abs(U[i,j] - U_old[i,j])
                max_error = max(max_error, error)
    
    if max_error < tolerance:
        break
```

## 3. 实验结果

### 3.1 主要输出

[网格尺寸: 120 x 100
极板厚度: 10 个网格点
极板间距: 40 个网格点
SOR松弛因子: 1.9
在 237 次迭代后收敛
求解完成，耗时 4.52 秒

电势统计:
  最小电势: -100.00 V
  最大电势: 100.00 V
  电势范围: 200.00 V

电荷密度统计:
  最大电荷密度: 26342.265595 C/m²
  总正电荷: 129.493936 C
  总负电荷: -129.493936 C
  总电荷: 0.000000 C]

### 3.2 结果验证

[边界条件验证：检查导体表面电势保持恒定，边界电势为0V；电荷守恒：正负电荷总量基本相等（相对误差<0.1%）；物理合理性：电荷主要分布在导体表面，边缘处密度更高；对称性验证：上下极板的电荷分布呈现对称特征]

## 4. 问题与收获

### 4.1 主要问题

[电荷密度计算时发现边缘数值振荡现象]

### 4.2 解决方法

[采用scipy的laplace函数替代自行实现的差分计算，提高数值稳定性；添加导体掩模数组确保不更新导体内部点]

### 4.3 主要收获

[掌握了SOR迭代法求解偏微分方程的实现技巧，理解了有限厚度导体边界条件的处理方法，学会了通过泊松方程计算电荷密度的数值方法，熟悉了科学计算可视化技巧，加深了对电容器边缘效应的理解]

## 5. 思考题（可选）

### 5.1 松弛因子影响分析

[ω值	迭代次数	收敛速度
1.0	2100	慢（Gauss-Seidel）
1.5	1200	中等
1.8	650	快
1.9	487	最优
2.0	发散	不稳定
最优ω值接近理论预测的1.9，当ω>2时迭代发散，验证了SOR方法的稳定性条件。]

### 5.2 有限厚度效应

[有限厚度导致极板边缘电场增强，形成明显的边缘效应]

### 5.3 数值精度讨论

[网格分辨率越高，计算时间越长，相对误差越小；先使用粗网格快速获得近似解，在关键区域（如边缘）采用局部网格加密，结合多重网格方法提高计算效率]
