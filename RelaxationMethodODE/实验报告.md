# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** [余维] **学号：** [20231050005] **完成日期：** [2025/6/18]

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
```

## 3. 实验结果

### 3.1 主要输出

- 最大高度：[121.59] m
- 到达最大高度时间：[5.00] s
- 迭代收敛次数：[10] 次

### 3.2 结果验证

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状

- ![Figure_1](https://github.com/user-attachments/assets/528bde78-11f9-4f82-a755-67d954e59bcb)


## 4. 问题与收获

### 4.1 主要问题

1. 收敛条件的设置

发散震荡	解在迭代中无限振荡	降低松弛因子ω(0.5<ω<1.0)

收敛过慢	迭代次数>5000次	采用超松弛(1.2<ω<1.8)或减小步长h

假收敛	提前收敛到错误解	添加残差检查：residual = (x[2:]-2*x[1:-1]+x[:-2])/h**2 + g

2. 迭代公式的正确实现
   
核心公式推导验证

1。微分方程 2.二阶中心差分 3.迭代格式


### 4.2 解决方法

1. 使用最大变化量作为收敛判据
2. 仔细处理数组索引，确保边界条件

   
绝对容差(abs_tol)	1e-6	物理精度需求（毫米级）

相对容差(rel_tol)	1e-4	解的大小变化范围

最大迭代次数	5000	收敛曲线平台期分析

最大变化量收敛判据和边界条件处理是松弛法的两大支柱。前者确保解的数值稳定性，后者保证解的物理正确性。

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。

实现了微分方程离散化：二阶中心差分格式 (x[i+1] - 2x[i] + x[i-1])/h² = -g

构建了松弛迭代框架：x_i^{(k+1)} = 0.5*(h²g + x_{i+1}^{(k)} + x_{i-1}^{(k)})

建立了收敛控制机制：基于无穷范数 max|Δx| < tol

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？

全局依赖性：边值问题需要同时满足整个区间两端的边界条件，而松弛法通过迭代同时更新所有网格点的值，能自然处理这种全局约束

同步求解：每个迭代步骤中，所有内部点的值都基于相邻点更新，这符合BVP中所有点相互耦合的特性

稳定性：对于IVP，逐步推进的方法（如Runge-Kutta）更高效；松弛法对IVP可能因步进误差积累导致不稳定

2. 如何选择合适的收敛容差和最大迭代次数？

收敛容差（tol）：

物理精度需求（如本例高度精度到厘米级可取1e-2）

机器精度限制（通常不低于1e-15）

经验值：工程问题常用1e-5~1e-8

最大迭代次数（max_iter）：

网格规模：网格点N增加时迭代次数∝N²

问题非线性程度：非线性强则需更多迭代

安全阈值：设为预期迭代次数的2-5倍（如本例10000）
